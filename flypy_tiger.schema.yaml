# Rime schema
# encoding: utf-8
# https://github.com/gaboolic/rime-shuangpin-fuzhuma

schema:
  schema_id: flypy_tiger
  name: å°é¹¤åŒæ‹¼+è™å½¢è¾…åŠ©
  version: "20240426"
  author:
    - Functoreality gaboolic
    - ä¿®æ”¹ æ½˜å…¬å­
  description: |
    å°é¹¤åŒæ‹¼+è¾…åŠ©ç 
  dependencies:
    - melt_eng
    - chaizi
    - radical_flypy
    - stroke
    - zrlf
    - emoji
    - easy_en


switches:
  - name: ascii_mode
    states: [ ä¸­, ï¼¡ ]
  - name: full_shape
    states: [ åŠ, å…¨ ]
  - name: simplification
    reset: 1
    states: [ ç¹, ç®€ ]
  - name: emoji
    states: [ ğŸ’€, ğŸ˜„ ]
  - name: ascii_punct
    states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]

engine:
  processors:
    #- lua_processor@select_character #ä»¥è¯å®šå­—
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    #- affix_segmentor@quanpin
    - affix_segmentor@emojis
    - affix_segmentor@verbatim ## not as the last of this list
    - affix_segmentor@soft_capslock
    - affix_segmentor@easy_en_simp
    - fallback_segmentor
  translators:
    - punct_translator
    - table_translator@custom_phrase
    - reverse_lookup_translator
    - reverse_lookup_translator@reverse_stroke
    - reverse_lookup_translator@reverse_zrlf
    - reverse_lookup_translator@reverse_hm
    - script_translator
    #- script_translator@quanpin
    - table_translator@emojis
    - table_translator@soft_capslock
    - lua_translator@date_translator    # æ—¶é—´ã€æ—¥æœŸã€æ˜ŸæœŸ
    - lua_translator@lunar              # å†œå†
    - table_translator@melt_eng
    - table_translator@cn_en
    - table_translator@easy_en_simp     # æ·»åŠ æ³¨é‡Šåï¼šåœç”¨å•è¯è¾“å…¥
    - lua_translator@unicode            # Unicode
    - lua_translator@number_translator  # æ•°å­—ã€é‡‘é¢å¤§å†™
    - table_translator@custom_phrase

  filters:
    - lua_filter@long_word_filter                   # é•¿è¯ä¼˜å…ˆï¼ˆé¡ºåºè¦æ±‚ï¼šé•¿è¯ä¼˜å…ˆ > Emojiï¼‰
    - simplifier@emoji                              # Emoji
    - lua_filter@reduce_english_filter              # é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®
    - simplifier@traditionalize                     # ç®€ç¹åˆ‡æ¢
    - uniquifier                                    # å»é‡

# Lua é…ç½®: æ—¥æœŸã€æ—¶é—´ã€æ˜ŸæœŸã€ISO 8601ã€æ—¶é—´æˆ³çš„è§¦å‘å…³é”®å­—
date_translator:
  date: date            # æ—¥æœŸï¼š 2022-11-29
  date: rq            # æ—¥æœŸï¼š 2022-11-29
  time: time            # æ—¶é—´ï¼š 18:13
  week: week            # æ˜ŸæœŸï¼š æ˜ŸæœŸäºŒ
  datetime: datetime    # ISO 8601ï¼š 2022-11-29T18:13:11+08:00
  timestamp: timestamp  # æ—¶é—´æˆ³ï¼š 1669716794

# Lua é…ç½®ï¼šå†œå†çš„è§¦å‘å…³é”®å­—
lunar: anl  # å†œå†ï¼š äºŒã€‡äºŒä¸‰å¹´å†¬æœˆäºŒå ç™¸å¯å¹´ï¼ˆå…”ï¼‰å†¬æœˆäºŒå
  
# Lua é…ç½®ï¼šé•¿è¯ä¼˜å…ˆ
# æå‡ count ä¸ªè¯è¯­ï¼Œæ’å…¥åˆ°ç¬¬ idx ä¸ªä½ç½®ã€‚
# ç¤ºä¾‹ï¼šå°† 2 ä¸ªè¯æ’å…¥åˆ°ç¬¬ 4ã€5 ä¸ªå€™é€‰é¡¹ï¼Œè¾“å…¥ jie å¾—åˆ°ã€Œ1æ¥ 2è§£ 3å§ 4é¥¥é¥¿ 5ææ¶ã€
long_word_filter:
  count: 2
  idx: 1

# Lua é…ç½®: é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®ã€‚
# è¯¦ç»†ä»‹ç» https://dvel.me/posts/make-rime-en-better/#çŸ­å•è¯ç½®é¡¶çš„é—®é¢˜
# æ­£å¸¸æƒ…å†µï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.rug 2.å¦‚æœ â€¦â€¦ ã€
# é™ä½ä¹‹åï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.å¦‚æœ 2.rug â€¦â€¦ ã€
# å‡ ç§æ¨¡å¼ï¼š
# all     é™ä½è„šæœ¬å†…ç½®çš„å•è¯ï¼ˆæ‰€æœ‰ 3~4 ä½é•¿åº¦ã€å‰ 2~3 ä½æ˜¯å®Œæ•´æ‹¼éŸ³ã€æœ€åä¸€ä½æ˜¯å£°æ¯ï¼‰ï¼Œwords ä½œä¸ºè‡ªå®šä¹‰çš„é¢å¤–è¡¥å……
# custom  å®Œå…¨è‡ªå®šä¹‰ï¼Œåªé™ä½ words é‡Œçš„
# none    ä¸é™ä½ä»»ä½•å•è¯ï¼Œç›¸å½“äºæ²¡æœ‰å¯ç”¨è¿™ä¸ª Lua
# ï¼ˆåŒ¹é…çš„æ˜¯ç¼–ç ï¼Œä¸æ˜¯å•è¯ï¼‰
reduce_english_filter:
  mode: custom  # all | custom | none
  idx: 2        # é™ä½åˆ°ç¬¬ idx ä¸ªä½ç½®
  # è‡ªå®šä¹‰çš„å•è¯åˆ—è¡¨ï¼Œç¤ºä¾‹åˆ—è¡¨æ²¡æœ‰é™ä½éƒ¨åˆ†å¸¸ç”¨å•è¯ï¼Œå¦‚ and cat mail Mac but bad shit â€¦â€¦
  words: [
    aid, ann,
    bail, bait, bam, band, bans, bat, bay, bend, bent, benz, bib, bid, bien, biz, boc, bop, bos, bud, buf, bach, bench, bush,
    cab, cad, cain, cam, cans, cap, cas, cef, chad, chan, chap, chef, cher, chew, chic, chin, chip, chit, coup, cum, cunt, cur, couch,
    dab, dag, dal, dam, dent, dew, dial, diet, dim, din, dip, dis, dit, doug, dub, dug, dunn, don,
    fab, fax, fob, fog, foul, fur,
    gag, gail, gain, gal, gam, gaol, ged, gel, ger, guam, gus, gut,
    hail, ham, hank, hans, hat, hay, heil, heir, hem, hep, hud, hum, hung, hunk, hut, hush,
    jim, jug,
    kat,
    lab, lad, lag, laid, lam, laos, lap, lat, lax, lay, led, leg, lex, liam, lib, lid, lied, lien, lies, linn, lip, lit, liz, lob, lug, lund, lung, lux, lash, loch, lush,
    mag, maid, mann, mar, mat, med, mel, mend, mens, ment, mil, mins, mint, mob, moc, mop, mos, mot, mud, mug, mum, mesh,
    nap, nat, nay, neil, nib, nip, noun, nous, nun, nut, nail, nash,
    pac, paid, pail, pain, pair, pak, pal, pam, pans, pant, pap, par, pat, paw, pax, pens, pic, pier, pies, pins, pint, pit, pix, pod, pop, pos, pot, pour, pow, pub, pinch, pouch,
    rand, rant, rent, rep, res, ret, rex, rib, rid, rig, rim, rub, rug, rum, runc, runs, ranch,
    sac, sail, sal, sam, sans, sap, saw, sax, sew, sham, shaw, shin, sig, sin, sip, sis, suit, sung, suns, sup, sur, sus,
    tad, tail, taj, tar, tax, tec, ted, tel, ter, tex, tic, tied, tier, ties, tim, tin, tit, tour, tout, tum,
    wag, wand, womens, wap, wax, weir, won,
    yan, yen,
    zach
  ]


speller:
  alphabet: zyxwvutsrqponmlkjihgfedcba[
  initials: zyxwvutsrqponmlkjihgfedcba
  delimiter: " '"
  ## speller æœªå…è®¸ aj è¡¨ç¤º an
  algebra:
    # - xform/^([aoe])$/$1$1/
    # - xform/^(ang)$/ah/
    # - xform/^([^\[]*)iu$/$1Q/
    # - xform/^([^\[]*)ei$/$1W/
    # - xform/uan$/R/
    # - xform/^([^\[]*)[uv]e$/$1T/
    # - xform/^([^\[]*)un$/$1Y/
    # - xform/^sh([^\[]+)/U$1/
    # - xform/^ch([^\[]+)/I$1/
    # - xform/^zh([^\[]+)/V$1/
    # - xform/^([^\[]*)uo$/$1O/
    # - xform/^([^\[]*)ie$/$1P/
    # - xform/i?ong$/S/
    # - xform/ing$|uai$/K/
    # - xform/^([^\[]+)ai$/$1D/
    # - xform/^([^\[]+)en$/$1F/
    # - xform/^([^\[]+)eng$/$1G/
    # - xform/[iu]ang$/L/
    # - xform/(.)ang$/$1H/
    # - xform/^([^\[]*)ian$/$1M/
    # - xform/^([^\[]+)an$/$1J/
    # - xform/^([^\[]+)ou$/$1Z/
    # - xform/^([^\[]*)[iu]a$/$1X/
    # - xform/^([^\[]*)iao$/$1N/
    # - xform/^([^\[]+)ao$/$1C/
    # - xform/^([^\[]*)ui$/$1V/
    # - xform/^([^\[]*)in$/$1B/
    # - xlit/QWRTYUIOPSDFGHJKLZXCVBNM/qwrtyuiopsdfghjklzxcvbnm/

    # æ¨¡ç³ŠéŸ³ å¯é€‰æ‹©æ€§å¼€å¯
    # - derive/^z([a-z])/v$1/
    # - derive/^c([a-z])/i$1/
    # - derive/^s([a-z])/u$1/
    # - derive/^v([a-z])/z$1/
    # - derive/^i([a-z])/c$1/
    # - derive/^u([a-z])/s$1/

    - derive/^(..)[[].+$/$1/
    - derive/^(..[[].).+$/$1/
    # - derive/^([jqxy])u/$1v/
    - derive/[[]//

    ## é£é”® å¯é€‰æ‹©æ€§å¼€å¯
    # - derive/^([yh])j/$1q/
    # - derive/^qx/qw/
    # - derive/^jn/jv/
    # - derive/^mn/mv/
    # - derive/^jm/jz/
    # - derive/^([y])h/$1g/
    # - derive/^([rgv])f/$1m/
    # - derive/^([rgv])c/$1n/


    
    

translator:
  dictionary: flypy_tiger.extended
  enable_completion: false
  ##  é»˜è®¤ä¸ºä¸è¶…è¿‡ 2 ä¸ªå­—çš„å€™é€‰é¡¹æ˜¾ç¤ºè¾“å…¥ç ï¼›å°† 2 æ”¹ä¸º 0 å¯å…³é—­ç¼–ç æç¤ºï¼Œ
  ##  æ”¹ä¸º 1 åˆ™æ˜¯åªæ˜¾ç¤ºå•å­—çš„è¾“å…¥ç ï¼Œä¾æ­¤ç±»æ¨ã€‚
  spelling_hints: 2
  comment_format:
    - "xform/(^|[ '])[^[]+[[]/$1/" ## ç¼–ç æç¤ºåªæ˜¾ç¤ºè¾…åŠ©ç éƒ¨åˆ†

  enable_user_dict: false # æ˜¯å¦å¼€å¯è‡ªåŠ¨è°ƒé¢‘ 
  # preedit_format:
    # - "xform/((^|[ '])[bpmfdtnljqx])n/$1iao/"
    # - "xform/((^|[ '])\\w)g/$1eng/"
    # - "xform/((^|[ '])\\w)q/$1iu/"
    # - "xform/((^|[ '])\\w)w/$1ei/"
    # - "xform/((^|[ '])[dtnlgkhjqxyvuirzcs])r/$1uan/"
    # - "xform/((^|[ '])\\w)t/$1ve/"
    # - "xform/((^|[ '])\\w)y/$1un/"
    # - "xform/((^|[ '])[dtnlgkhvuirzcs])o/$1uo/"
    # - "xform/((^|[ '])\\w)p/$1ie/"
    # - "xform/((^|[ '])[jqx])s/$1iong/"
    # - "xform/((^|[ '])\\w)s/$1ong/"
    # - "xform/((^|[ '])\\w)d/$1ai/"
    # - "xform/((^|[ '])\\w)f/$1en/"
    # - "xform/((^|[ '])\\w)h/$1ang/"
    # - "xform/((^|[ '])\\w)j/$1an/"
    # - "xform/((^|[ '])[gkhvuirzcs])k/$1uai/"
    # - "xform/((^|[ '])\\w)k/$1ing/"
    # - "xform/((^|[ '])[jqxnl])l/$1iang/"
    # - "xform/((^|[ '])\\w)l/$1uang/"
    # - "xform/((^|[ '])\\w)z/$1ou/"
    # - "xform/((^|[ '])[gkhvuirzcs])x/$1ua/"
    # - "xform/((^|[ '])\\w)x/$1ia/"
    # - "xform/((^|[ '])\\w)c/$1ao/"
    # - "xform/((^|[ '])[dtgkhvuirzcs])v/$1ui/"
    # - "xform/((^|[ '])\\w)b/$1in/"
    # - "xform/((^|[ '])\\w)m/$1ian/"
    # - "xform/(^|[ '])([aoe])\\2(\\w)/$1$2$3/"
    # - "xform/(^|[ '])v/$1zh/"
    # - "xform/(^|[ '])i/$1ch/"
    # - "xform/(^|[ '])u/$1sh/"
    # - "xform/((^|[ '])[jqxy])v/$1u/"
    # - "xform/((^|[ '])[nl])v/$1Ã¼/"

# æ¬¡ç¿»è¯‘å™¨ï¼Œè‹±æ–‡
melt_eng:
  dictionary: melt_eng     # æŒ‚è½½è¯åº“ melt_eng.dict.yaml
  enable_sentence: false   # ç¦æ­¢é€ å¥
  enable_user_dict: false  # ç¦ç”¨ç”¨æˆ·è¯å…¸
  initial_quality: 1.1     # åˆå§‹æƒé‡
  comment_format:          # è‡ªå®šä¹‰æç¤ºç 
    - xform/.*//           # æ¸…ç©ºæç¤ºç 

# ä¸­è‹±æ··åˆè¯æ±‡
cn_en:
  dictionary: ""
  user_dict: en_dicts/cn_en_flypy
  db_class: stabledb
  enable_completion: true
  enable_sentence: false
  initial_quality: 0.5
  comment_format:
    - xform/^.+$//

# è‡ªå®šä¹‰çŸ­è¯­ï¼šcustom_phrase.txt 
custom_phrase:
  dictionary: ""
  user_dict: custom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 1

reverse_lookup:
  dictionary: radical_flypy # https://github.com/mirtlecn/rime-radical-pinyin
  enable_completion: true
  prefix: "az"
  suffix: "'"
  tips: ã€”ç»„å­—ã€•
  preedit_format:
    # - xlit/hspnz/ä¸€ä¸¨ä¸¿ä¸¶ä¹™/

reverse_zrlf:
  tag: reverse_zrlf
  dictionary: zrlf
  enable_completion: true
  prefix: "alf"
  suffix: "'"
  tips: ã€”ä¸¤åˆ†ã€•
  preedit_format:
    # - xlit/hspnz/ä¸€ä¸¨ä¸¿ä¸¶ä¹™/

reverse_hm:
  tag: reverse_hm
  dictionary: tiger
  enable_completion: true
  prefix: "ahm"
  suffix: "'"
  tips: ã€”è™ç ã€•
  preedit_format:
    - xform/^ahm/è™ç :/

reverse_stroke:
  tag: reverse_stroke
  dictionary: stroke # stroke
  enable_completion: true
  prefix: "ab"
  suffix: "'"
  tips: ã€”ç­†ç•«hspnzã€• # ã€”ç­†ç•«ã€•
  preedit_format:
    - xlit/hspnz/ä¸€ä¸¨ä¸¿ä¸¶ä¹™/


# Emoji
emoji:
  option_name: emoji
  opencc_config: emoji.json
  inherit_comment: false  # åœ¨ corrector.lua åŠåæŸ¥ä¸­ï¼Œemoji è¿”å›ç©ºæ³¨é‡Š


# ç®€ç¹åˆ‡æ¢
traditionalize:
  option_name: traditionalization
  opencc_config: s2t.json  # s2t.json | s2hk.json | s2tw.json | s2twp.json
  tips: none               # è½¬æ¢æç¤º: all éƒ½æ˜¾ç¤º | char ä»…å•å­—æ˜¾ç¤º | none ä¸æ˜¾ç¤ºã€‚
  tags: [ abc, number, gregorian_to_lunar ]  # é™åˆ¶åœ¨å¯¹åº” tagï¼Œä¸å¯¹å…¶ä»–å¦‚åæŸ¥çš„å†…å®¹åšç®€ç¹è½¬æ¢
  
# æ ‡ç‚¹ç¬¦å·
# punctuator ä¸‹é¢æœ‰ä¸‰ä¸ªå­é¡¹ï¼š
#   full_shape å…¨è§’æ ‡ç‚¹æ˜ å°„
#   half_shape åŠè§’æ ‡ç‚¹æ˜ å°„
#   symbols    Rime çš„é¢„è®¾é…ç½®æ˜¯ä»¥ '/' å‰ç¼€å¼€å¤´è¾“å‡ºä¸€ç³»åˆ—å­—ç¬¦ï¼Œè‡ªå®šä¹‰çš„ symbols_caps_v.yaml ä¿®æ”¹æˆäº† 'V' å¼€å¤´ã€‚
punctuator:
  full_shape:
    __include: default:/punctuator/full_shape  # ä» default.yaml å¯¼å…¥é…ç½®
  half_shape:
    __include: default:/punctuator/half_shape  # ä» default.yaml å¯¼å…¥é…ç½®
  symbols:
    __include: symbols_caps_v:/symbols         # ä» symbols_caps_v.yaml å¯¼å…¥é…ç½®

key_binder:
  import_preset: default
  bindings:
    #- { when: composing, accept: Tab, send: '[' } ## å–æ¶ˆæ³¨é‡Šåï¼štabå¼•å¯¼è¾…åŠ©ç 
    - { when: composing, accept: Control+m, send: Return }
    - { when: composing, accept: Control+w, send: Control+BackSpace }
    - { when: has_menu, accept: semicolon, send: 2 }
    - { when: has_menu, accept: slash, send: 3 }
    - { when: composing, accept: Control+i, send: Shift+Right }
    - { when: composing, accept: Control+o, send: Shift+Left }
    ## å¯¹ä»¥ä¸‹4è¡Œå–æ¶ˆæ³¨é‡Šåï¼šå¯ç”¨å…‰æ ‡å›é€€è‡³ç‰¹å®šéŸ³èŠ‚åã€è¡¥å……è¾…åŠ©ç çš„åŠŸèƒ½
    ## ï¼ˆè‡ªç„¶ç ç­‰å…¶ä»–åŒæ‹¼ç”¨æˆ·è¯·åœ¨ pinyin_switch.yaml ä¸­è®¾ç½®ï¼‰
    #- { when: composing, accept: Control+1, send_sequence: '{Home}{Shift+Right}[' }
    #- { when: composing, accept: Control+2, send_sequence: '{Home}{Shift+Right}{Shift+Right}[' }
    #- { when: composing, accept: Control+3, send_sequence: '{Home}{Shift+Right}{Shift+Right}{Shift+Right}[' }
    #- { when: composing, accept: Control+4, send_sequence: '{Home}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}[' }

recognizer:
  # import_preset: default
  patterns:
    uppercase: "^[A-Z].*$"
    punct: '^/[015-9A-Za-z]+$' ## use "/er" instead of "/2"
    ## æ‹†å­—ã€ç¬”ç”»ã€è™ç : 
    reverse_lookup: "^az[a-z]*'?$" # "[[]b[a-z]*'?$"
    reverse_stroke: "^ab[A-Za-z]*$"
    reverse_hm: "^ahm[A-Za-z]*$"
    reverse_zrlf: "^alf[A-Za-z]*$"

    easy_en_simp: "^aw[a-z]*"
    unicode: "^U[a-f0-9]+"              # è„šæœ¬å°†è‡ªåŠ¨è·å–ç¬¬ 2 ä¸ªå­—ç¬¦ U ä½œä¸ºè§¦å‘å‰ç¼€ï¼Œå“åº” lua_translator@unicodeï¼Œè¾“å‡º Unicode å­—ç¬¦
    number: "^R[0-9]+[.]?[0-9]*"        # è„šæœ¬å°†è‡ªåŠ¨è·å–ç¬¬ 2 ä¸ªå­—ç¬¦ R ä½œä¸ºè§¦å‘å‰ç¼€ï¼Œå“åº” lua_translator@number_translatorï¼Œæ•°å­—é‡‘é¢å¤§å†™
    gregorian_to_lunar: "^N[0-9]{1,8}"  # è„šæœ¬å°†è‡ªåŠ¨è·å–ç¬¬ 2 ä¸ªå­—ç¬¦ N ä½œä¸ºè§¦å‘å‰ç¼€ï¼Œå“åº” lua_translator@lunarï¼Œå…¬å†è½¬å†œå†ï¼Œè¾“å…¥ N20240115 å¾—åˆ°ã€ŒäºŒã€‡äºŒä¸‰å¹´è…Šæœˆåˆäº”ã€

menu:
  page_size: 5


melt_eng:
  dictionary: melt_eng
  enable_completion: true
  enable_sentence: false
  initial_quality: "-1"
  spelling_hints: 9

easy_en_simp:
  tag: easy_en_simp
  dictionary: easy_en
  enable_completion: true
  enable_sentence: false
  prefix: "aw"
  # suffix: "'"
  tips: "è‹±æ–‡å•è¯"
  spelling_hints: 9
  comment_format:
    - xform/^.+$//

grammar:
  language: zh-hans-t-huayu-v7-bgw
  contextual_suggestions: true
  collocation_max_length: 6
  collocation_min_length: 2
  collocation_penalty: -20
  non_collocation_penalty: -20
  weak_collocation_penalty: -26
  rear_penalty: 0

